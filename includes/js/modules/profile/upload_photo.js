$(document).ready(function(){var b=Backbone.Model.extend({defaults:{url:"",thumbnail_url:"",user_id:window.aboutModel.get("user_id")},url:function(){return BASE_URL+"api/user/id/"+this.get("user_id")+"/photo?thumbnail=true"}});var a=new b();$("#submit-photo").attr("disabled",true);$("#fileupload").fileupload({add:function(d,c){$("#submit-photo").removeAttr("disabled");$("#preview-img").remove();$("#profile-img-default").hide();$("#submit-photo").unbind("click");$("#submit-photo").bind("click",function(){c.submit()});window.loadImage(c.files[0],function(e){$(e).attr("id","preview-img");$(e).addClass("thumbnail");$(e).attr("height",106);$(e).attr("width",106);$("#profile-img-container").append(e)})},start:function(c){$("#upload-progress-container").removeClass("hidden")},progress:function(d,c){progress=parseInt(c.loaded/c.total*100,10);$("#upload-progress").css("width",progress+"%").find("span").html(progress+"%")},done:function(d,c){if(c.result[0].error!=undefined){$("#photo-message").show().html('<span class="label label-important">'+c.result[0].error+".</span>")}else{setTimeout(function(){$("#upload-progress-container").hide("fade");$("#myUpload").modal("hide")},2000);$("#photo-message").show().html('<span class="label label-success">Photo successfully uploaded.</span>');window.aboutModel.set("photo",c.result[0].name).save();a.fetch({success:function(g,e,f){$("#user-photo").attr("src",g.get("url"))}})}}})});